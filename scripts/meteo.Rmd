---
title: "meteo"
author: "Sarah Poirier"
date: "2024-06-13"
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(patchwork)
```

# Temperature
## Import data
```{r}
setwd("~/Library/CloudStorage/OneDrive-USherbrooke/Universite/Maitrise/WRITING/Bioaerosol_article/meteo")

meteo_SHB_2022 <- read_csv("meteo_SHB_2022.csv")
meteo_MTL_2022 <- read_csv("meteo_MTL_2022.csv")
meteo_QC_2022  <- read_csv("meteo_QC_2022.csv")

meteo_SHB_2022 <- meteo_SHB_2022[,c(3,5,6,7,8,10,12,14,24)]
meteo_MTL_2022 <- meteo_MTL_2022[,c(3,5,6,7,8,10,12,14,24)]
meteo_QC_2022  <- meteo_QC_2022 [,c(3,5,6,7,8,10,12,14,24)]

meteo <- rbind(meteo_SHB_2022, meteo_MTL_2022, meteo_QC_2022)

```

## Meteo all cities
```{r}
meteo <- subset(meteo, Mois == "05" | Mois == "06" | Mois == "08" | Mois == "09" | Mois == "10")

colnames(meteo) <- c("City","Date","Year","Month","Day","Max","Min","Mean","Rain")

meteo <- as.data.frame(meteo)

# Replace commas with dots in the specified column
meteo <- meteo %>%
  mutate(Max = gsub(",", ".", Max))
meteo <- meteo %>%
  mutate(Min = gsub(",", ".", Min))
meteo <- meteo %>%
  mutate(Mean = gsub(",", ".", Mean))
meteo <- meteo %>%
  mutate(Rain = gsub(",", ".", Rain))

meteo$City[meteo$City == "MCTAVISH"] <- "Montréal"
meteo$City[meteo$City == "BEAUPORT"] <- "Québec"
meteo$City[meteo$City == "SHERBROOKE"] <- "Sherbrooke"

meteo$Date  <- as.Date(meteo$Date)
meteo$City  <- as.factor(meteo$City)
meteo$Year  <- as.factor(meteo$Year)
meteo$Month <- as.factor(meteo$Month)
meteo$Day   <- as.factor(meteo$Day)
meteo$Max   <- as.numeric(meteo$Max)
meteo$Min   <- as.numeric(meteo$Min)
meteo$Mean  <- as.numeric(meteo$Mean)
meteo$Rain  <- as.numeric(meteo$Rain)

meteo$Time  <- format(as.Date(meteo$Date), "%m-%d")
```

### Meteo subsets by city
```{r}
meteo_MTL <- subset(meteo, City == "Montréal")

meteo_QC  <- subset(meteo, City == "Québec")

meteo_SHB <- subset(meteo, City == "Sherbrooke")
```

# Figures Temperature
## Figure Montréal
```{r}
###### MTL
# Spring MTL: 05-03 to 05-07
# Summer MTL: 06-(08,10,12-13)
# Fall MTL:   08-31 to 09-(07,09)

plot_MTL <- ggplot(meteo_MTL, aes(x=Time, y=Mean, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "indianred3")+
  annotate("rect", xmin = "05-03", xmax = "05-07", ymin = 0, ymax = 25, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "06-08", xmax = "06-09", ymin = 0, ymax = 25, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "06-10", xmax = "06-11", ymin = 0, ymax = 25, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "06-12", xmax = "06-14", ymin = 0, ymax = 25, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "08-31", xmax = "09-09", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  ylab("Temperature (°C)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_MTL
```

## Figure Québec city
```{r}
# Spring QC:  05-(12,13,14,18,19)
# Fall QC:    09-(29,30) and 10-(01,02,05)

plot_QC <- ggplot(meteo_QC, aes(x=Time, y=Mean, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "khaki3")+
  annotate("rect", xmin = "05-12", xmax = "05-15", ymin = 0, ymax = 25, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "05-18", xmax = "05-20", ymin = 0, ymax = 25, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "09-29", xmax = "10-03", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "10-05", xmax = "10-06", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  ylab("Temperature (°C)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_QC
```

## Figure Sherbrooke
```{r}
# Spring SHB: 05-09 to 05-11
# Summer SHB: 05-31 to 06-03
# Fall SHB:   09-(21,23,25,27) and 10-04
plot_SHB <- ggplot(meteo_SHB, aes(x=Time, y=Mean, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "darkolivegreen3")+
  annotate("rect", xmin = "05-09", xmax = "05-11", ymin = 0, ymax = 25, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "05-31", xmax = "06-03", ymin = 0, ymax = 25, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "09-21", xmax = "09-22", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-23", xmax = "09-24", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-25", xmax = "09-26", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-27", xmax = "09-28", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "10-04", xmax = "10-05", ymin = 0, ymax = 25, alpha = 0.5, fill = "#F29040")+
  ylab("Temperature (°C)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_SHB
```

## Patchwork
```{r}
meteo_all_cities <- plot_MTL / plot_QC / plot_SHB
meteo_all_cities + plot_annotation(tag_levels = "A") # 20 x 33 landscape
```

# Figures precipitations
## Figure Montréal
```{r}
###### MTL
# Spring MTL: 05-03 to 05-07
# Summer MTL: 06-(08,10,12-13)
# Fall MTL:   08-31 to 09-(07,09)

plot_MTL_Prec <- ggplot(meteo_MTL, aes(x=Time, y=Rain, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "indianred3")+
  annotate("rect", xmin = "05-03", xmax = "05-07", ymin = 0, ymax = 65, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "06-08", xmax = "06-09", ymin = 0, ymax = 65, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "06-10", xmax = "06-11", ymin = 0, ymax = 65, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "06-12", xmax = "06-14", ymin = 0, ymax = 65, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "08-31", xmax = "09-09", ymin = 0, ymax = 65, alpha = 0.5, fill = "#F29040")+
  ylab("Precipitations (mm)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_MTL_Prec
```

## Figure Québec city
```{r}
# Spring QC:  05-(12,13,14,18,19)
# Fall QC:    09-(29,30) and 10-(01,02,05)

plot_QC_Prec <- ggplot(meteo_QC, aes(x=Time, y=Rain, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "khaki3")+
  annotate("rect", xmin = "05-12", xmax = "05-15", ymin = 0, ymax = 42, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "05-18", xmax = "05-20", ymin = 0, ymax = 42, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "09-29", xmax = "10-03", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "10-05", xmax = "10-06", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  ylab("Precipitations (mm)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_QC_Prec
```

## Figure Sherbrooke
```{r}
# Spring SHB: 05-09 to 05-11
# Summer SHB: 05-31 to 06-03
# Fall SHB:   09-(21,23,25,27) and 10-04
plot_SHB_Prec <- ggplot(meteo_SHB, aes(x=Time, y=Rain, color = City, group = City)) + 
  geom_point()+ 
  geom_line()+
  theme_bw()+
  scale_color_manual(values = "darkolivegreen3")+
  annotate("rect", xmin = "05-09", xmax = "05-11", ymin = 0, ymax = 42, alpha = 0.5, fill = "#ffb3c6")+
  annotate("rect", xmin = "05-31", xmax = "06-03", ymin = 0, ymax = 42, alpha = 0.5, fill = "#61a5c2")+
  annotate("rect", xmin = "09-21", xmax = "09-22", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-23", xmax = "09-24", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-25", xmax = "09-26", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "09-27", xmax = "09-28", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  annotate("rect", xmin = "10-04", xmax = "10-05", ymin = 0, ymax = 42, alpha = 0.5, fill = "#F29040")+
  ylab("Precipitations (mm)")+
  xlab("Julian days")+
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(size =11),
        axis.title = element_text(size = 14),
        legend.position = "none");plot_SHB_Prec
```

## Patchwork
```{r}
meteo_all_cities_Prec <- plot_MTL_Prec / plot_QC_Prec / plot_SHB_Prec
meteo_all_cities_Prec + plot_annotation(tag_levels = "A") # 20 x 33 landscape
```

